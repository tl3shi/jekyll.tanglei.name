---
id: 292
title: 范式
date: 2011-01-05T10:02:02+00:00
author: tanglei
layout: post
guid: http://www.tanglei.name/?p=292
duoshuo_thread_id:
  - 1351844048792453173
categories:
  - 数据库应用
  - 网络文摘
tags:
---
**第一范式（1NF）：在关系模式R中的每一个具体关系r中，如果每个属性值 都是不可再分的最小数据单位，则称R是第一范式的关系。<span>（字段不可分）</span>**

**＠另一种说法：删除重复列，合并同类列，使数据记录每一行都是唯一的，减少了列上的冗余．****<span style="color: #99ccff;"><br /> </span>**

<span style="color: #99ccff;">例：如职工号，姓名，电话号码组成一个表（一个人可能有一个办公室电话 和一个家里电话号码） 规范成为1NF有三种方法： 一是重复存储职工号和姓名。这样，关键字只能是电话号码。 二是职工号为关键字，电话号码分为单位电话和住宅电话两个属性 三是职工号为关键字，但强制每条记录只能有一个电话号码。 以上三个方法，第一种方法最不可取，按实际情况选取后两种情况。</span> ****

**第二范式（2NF）：如果关系模式R（U，F）中的所有非主属性都完全依赖于任意一个候选关键字，则称关系R 是属于第二范式的。 <span>（消除部分依赖）</span>**

<span style="color: #99ccff;">例：选课关系 SCI（SNO，CNO，GRADE，CREDIT）其中SNO为学号， CNO为课程号，GRADEGE 为成绩，CREDIT 为学分。 由以上条件，关键字为组合关键字（SNO，CNO） 。</span>

<span style="color: #99ccff;">问题：<br /> a.数据冗余，假设同一门课由40个学生选修，学分就 重复40次。<br /> b.更新异常，若调整了某课程的学分，相应的元组CREDIT值都要更新，有可能会出现同一门课学分不同。<br /> c.插入异常，如计划开新课，由于没人选修，没有学号关键字，只能等有人选修才能把课程和学分存入。<br /> d.删除异常，若学生已经结业，从当前数据库删除选修记录。某些门课程新生尚未选修，则此门课程及学分记录无法保存。</span>

<span style="color: #99ccff;">原因：函数依赖［（SNO，CNO）→GRADE, CNO→CREDIT］非关键字属性CREDIT仅函数依赖于CNO，也就是CREDIT部分依赖组合关键字（SNO，CNO）而不是完全依赖。 </span>

<span style="color: #99ccff;">解决方法：分成两个关系模式 SC1（SNO，CNO，GRADE），C2（CNO，CREDIT）。新关系包括两个关系模式，它们之间通过SC1中的外关键字CNO相联系，需要时再进行自然联接，恢复了原来的关系</span>

**第三范式（3NF）：如果关系模式R（U，F）中的所有非主属性对任何候选关键字都不存在传递信赖，则称关系R是属于第三范式的。 <span>（消除非主属性对关键字的传递依赖）</span>**

<span style="color: #99ccff;">例：如S1（SNO，SNAME，DNO，DNAME，LOCATION） 各属性分别代表学号， 姓名，所在系，系名称，系地址。</span>

<span style="color: #99ccff;">问题：<br /> 关键字SNO决定各个属性。由于是单个关键字，没有部分依赖的问题，肯定是2NF。但这关系肯定有大量的冗余，有关学生所在的几个属性DNO，DNAME，LOCATION将重复存储，插入，删除和修改时也将产生类似以上例的情况。</span>

<span style="color: #99ccff;">原因：函数依赖［SNO→SNAME, SNO→DNO, DNO→DNAME, DNO→LOCATION］．关系中存在传递依赖造成的。即SNO -> DNO。 而DNO -> SNO却不存在，DNO -> LOCATION, 因此关键辽 SNO 对 LOCATION 函数决定是通过传递依赖 SNO -> LOCATION 实现的。也就是说，SNO不直接决定非主属性LOCATION。 </span>

<span style="color: #99ccff;">解决方法：分为两个关系 S（SNO，SNAME，DNO），D（DNO，DNAME，LOCATION）</span>

 **BCNF：如果关系模式R（U，F）的所有属性（包括主属性和非主属性）都不传递依赖于R的任何候选关键字，那么称关系R是属于BCNF的。或是关系模式R，如果每个决定因素都包含关键字（而不是被关键字所包含），则RCNF的关系模式。** <span><strong>（消除主属性对关键字的传递依赖）</strong></span>

 <span style="color: #99ccff;">例：配件管理关系模式 WPE（WNO，PNO，ENO，QNT）分别表仓库号，配件号，职工号，数量。<br /> a.一个仓库有多个职工。<br /> b.一个职工仅在一个仓库工作。<br /> c.每个仓库里一种型号的配件由专人负责，但一个人可以管理几种配件。<br /> d.同一种型号的配件可以分放在几个仓库中。 </span>

<span style="color: #99ccff;">分析：由a,b得函数依赖［ENO→WNO]，由c,d得函数依赖［(WNO, PNO)→ENO, (WNO, PNO)→QNT］，因为（WNO，PNO） -> QNT，（WNO，PNO）-> ENO ，因此 （WNO，PNO）可以决定整个元组，是一个候选关键字。根据ENO->WNO，（ENO，PNO）->QNT，故（ENO，PNO）也能决 定整个元组，为另一个候选关键字。属性ENO，WNO，PNO 均为主属性，只有一个非主属性QNT。它对任何一个候选关键字都是完全函数依赖的，并且是直接依赖，所以该关系模式是3NF。因为 ENO->WNO，主属性ENO是WNO的决定因素，但是它本身不是关键字，只是组合关键字的一部分。这就造成主属性WNO对另外一个候选关键字 （ENO，PNO）的部 分依赖，因为（ENO，PNO）-> WNO但反过来不成立，而ENO->WNO，故（ENO，PNO）-> WNO 也是传递依赖。 </span>

<span style="color: #99ccff;">问题：虽然没有非主属性对候选关键辽的传递依赖，但<span style="text-decoration: underline;">存在主属性对候选关键字的传递依赖</span>，同样也会带来麻烦。如一个新职工分配到仓库工作，但暂时处于实习阶段，没有独立负责对某些配件的管理任务。由于缺少关键字的一部分PNO而无法插入到该关系中去。又如某个人改成不管配件了去负责安全，则在删除配件的同时该职工也会被删除。 </span>

<span style="color: #99ccff;">解决办法：分成管理EP（ENO，PNO，QNT），关键字是（ENO，PNO）工作EW（ENO，WNO）其关键字是ENO </span>

<span style="color: #99ccff;">缺点：分解后函数依赖的保持性较差。如此例中，由于分解,函数依赖（WNO，PNO）-> ENO 丢失了, 因而对原来的语义有所破坏。没有体现出每个仓库里一种部件由专人负责。有可能出现 一部件由两个人或两个以上的人来同时管理。因此，分解之后的关系模式降低了部分完整性约束。</span>

**第四范式（3NF）：<span>消除多值依赖．</span>**

**在关系模式中，函数依赖不能表示属性值之间的一对多联系，这些属性之间有些虽然没有直接关系，但存在间接的关系，把没有直接联系、但有间接的联系称为多值依赖的数据依赖。如，教师和学生之间没有直接联系，但教师和学生可通过系名，或任课把教师和学生联系起来。**

<span style="color: #99ccff;">例：关系<仓库管理员，仓库号，库存产品号>，假设一个一个产品只能放到一个仓库中，但 是一个仓库可以由若干管理员，那么对应于一个<仓库管理员，库存产品号>有一个仓库号，而实际上，这个仓库号只与库存产品号有关，与管理员无 关，就说这是多值依赖<br /> 解决：<仓库管理员，仓库号> <仓库号，库存产品号></span>

一个关系分解成多个关系，要使得分解有意义，起码的要求是分解后不丢失原来的信息。这些信息不仅包括数据本身，而且包括由函数依赖所表示的数据之间的相互制约。进行分解的目标是达到更高一级的规范化程度，但是**分解的同时必须考虑两个问题：无损联接性和保持函数依赖。**有时往往不可能做到既有无损联接性，又完全保持函数依赖。需要根据需要进行权衡。

**1NF直到BCNF的四种范式之间有如下关系：**
  
BCNF包含了3NF包含2NF包含1NF

**小结：
  
目地：**规范化目的是使结构更合理，消除存储异常，使数据冗余尽量小，便于插入、删除和更新
  
 **原则：**遵从概念单一化 &#8220;一事一地&#8221;原则，即一个关系模式描述一个实体或实体间的一种联系。规范的实质就是概念的单一化。
  
 **方法：**将关系模式投影分解成两个或两个以上的关系模式。**
  
要求：**分解后的关系模式集合应当与原关系模式&#8221;等价&#8221;，即经过自然联接可以恢复原关系而不丢失信息，并保持属性间合理的联系。

**注意：**一个关系模式结这分解可以得到不同关系模式集合，也就是说分解方法不是唯一的。最小冗余的要求必 须以分解后的数据库能够表达原来数据库所有信息为前提来实现。其根本目标是节省存储空间，避免数据不一致性，提高对关系的操作效率，同时满足应用需求。实 际上，并不一定要求全部模式都达到BCNF不可。有时故意保留部分冗余可能更方便数据查询。尤其对于那些更新频度不高，查询频度极高的数据库系统更是如 此。
  
在关系数据库中，除了函数依赖之外还有多值依赖，联接依赖的问题，从而提出了第四范式，第五范式等更高一级的规范化要求。在此，以后再谈。

<span style="color: #99ccff;">＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝</span>

［例题］学生(学生号,学生名字,宿舍号(单人),宿舍类型,宿舍价格,俱乐部,俱乐部入会费学生的兄弟姐妹(sibling),学生的昵称)假设 学生所付的住宿费是不同的,这取决于房子类型,但同一俱乐部的成员所付费用相同,一个学生有多个昵称将该表转换成一张或多张BCNF 和  第4范式的表 并指出他们的主关键字,候选关键字外键 以及参照物完整性约束

**bc范式**
  
学生(学生号,学生名字,学生的兄弟姐妹(sibling),学生的昵称,宿舍号,俱乐部)
  
宿舍(宿舍号(单人),宿舍类型,宿舍价格)
  
俱乐部(俱乐部,俱乐部入会费)

**第4范式**
  
学生1(学生号(主),学生名字)
  
学生2(学生号,学生的兄弟姐妹)
  
学生3(学生号,学生的昵称)
  
学生4(学生号(主),宿舍号(外))
  
学生5(学生号(主),俱乐部(外))

宿舍1(宿舍号(主),宿舍类型(外) )
  
宿舍2(宿舍类型(主),宿舍价格)

&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;

以上内容转自http://blog.csdn.net/jjennysky/archive/2007/04/29/1592258.aspx
